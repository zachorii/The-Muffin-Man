<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>The Muffin Man</title>

<style>
  body { margin:0; font-family: Arial, sans-serif; background:#faf6f1; color:#333; }
  header { background:#4b2e2e; color:#fff; text-align:center; padding:36px 16px; }
  h1 { margin:0; font-size:38px; }
  header p { margin:8px 0 0; opacity:.9; }
  main { max-width: 980px; margin: 0 auto; padding: 24px 16px 60px; }

  .grid { display:grid; grid-template-columns: 1fr; gap: 16px; }
  @media (min-width: 860px) { .grid { grid-template-columns: 1.2fr .8fr; } }

  .card {
    background:#fff; border-radius:12px; padding:18px;
    box-shadow: 0 4px 12px rgba(0,0,0,.08);
  }

  h2 { margin:0 0 10px; }
  .muted { color:#666; margin: 6px 0 0; }

  .menu p { margin:8px 0; }

  .builder { display:grid; gap: 12px; }
  .pack {
    border: 1px solid #e6e6e6; border-radius: 12px; padding: 14px;
    display:grid; gap: 10px; background:#fff;
  }
  .pack-title { display:flex; justify-content: space-between; align-items: baseline; gap: 10px; }
  .pill { font-size: 16px; font-weight: 900; background:#4b2e2e; color: #fff; padding: 8px 16px; border-radius: 999px; }

  label { font-weight: 700; font-size: 13px; }
  .row { display:grid; grid-template-columns: 1fr 160px; gap: 10px; }
  @media (max-width: 520px) { .row { grid-template-columns: 1fr; } }

  select, input, textarea {
    width:100%; padding:10px 12px; border-radius:10px;
    border:1px solid #d4d4d4; font: inherit; background:#fff;
  }

  button {
    padding: 10px 12px; border-radius: 10px; border: none;
    background:#4b2e2e; color:#fff; font-weight: 800; cursor: pointer;
  }
  button:hover { background:#6a3f3f; }
  button.secondary { background:#f3f3f3; color:#111; border:1px solid #ddd; }
  button.secondary:hover { background:#ededed; }

  .cart-list { margin: 0; padding-left: 18px; }
  .cart-item { display:flex; justify-content: space-between; gap: 12px; margin: 8px 0; }
  .cart-item small { color:#666; display:block; }
  .cart-actions { display:flex; gap: 8px; align-items:center; }
  .remove-btn {
    background:#fff; color:#4b2e2e; border:1px solid #4b2e2e;
    padding: 6px 10px; border-radius: 10px; font-weight: 800;
  }
  .remove-btn:hover { background:#faf6f1; }

  .total { font-size: 18px; font-weight: 900; }
  .divider { height:1px; background:#eee; margin: 14px 0; }

  .notice {
    background:#fff7e8; border:1px solid #f2d7ad; padding: 10px 12px;
    border-radius: 12px; color:#7a4f00; margin-top: 12px;
  }
</style>
</head>

<body>
<header>
  <h1>The Muffin Man</h1>
  <p>Small-batch muffins with crunchy crumble toppings</p>
</header>

<main>
  <div class="grid">
    <!-- LEFT COLUMN -->
    <div class="card">
      <h2>Menu</h2>
      <div class="menu">
        <p><strong>Blueberry Cinnamon</strong> – Sweet Blueberry Muffin with Cinnamon Crumble</p>
        <p><strong>Strawberry Lemon</strong> – Muffin with Ripe Strawberries & Lemon Crumble</p>
        <p><strong>Chocolate Raspberry</strong> – Chocolate muffin with Tart Raspberries & Cocoa Crumble</p>
        <p><strong>Double Chocolate</strong> – Chocolate muffin with Milk & Dark Chocolate chunks topped by Espresso Crumble</p>
      </div>

      <div class="divider"></div>

      <h2>Build Your Order</h2>
      <p class="muted">Add singles, half dozens, and/or dozens to your cart, then submit one order.</p>

      <div class="builder">
        <!-- PACK 1: SINGLE -->
        <div class="pack">
          <div class="pack-title">
            <strong>Single Muffin</strong>
            <span class="pill">$3 each</span>
          </div>

          <div class="row">
            <div>
              <label for="flavorSingle">Flavor</label>
              <select id="flavorSingle">
                <option>Blueberry</option>
                <option>Strawberry Lemon</option>
                <option>Chocolate Raspberry</option>
                <option>Double Chocolate</option>
              </select>
            </div>
            <div>
              <label for="qtySingle">How many singles?</label>
              <select id="qtySingle"></select>
            </div>
          </div>

          <button type="button" onclick="addToCart('single')">Add Singles</button>
          <p style="font-size:12px; color:#777; margin:0;">
            <strong>Need 6 or more? Choose Half Dozen for better value.</strong>
          </p>
        </div>

        <!-- PACK 2: HALF DOZEN -->
        <div class="pack">
          <div class="pack-title">
            <strong>Half Dozen (6)</strong>
            <span class="pill">$15 per 6</span>
          </div>

          <div class="row">
            <div>
              <label for="flavorHalf">Flavor</label>
              <select id="flavorHalf">
                <option>Blueberry</option>
                <option>Strawberry Lemon</option>
                <option>Chocolate Raspberry</option>
                <option>Double Chocolate</option>
              </select>
            </div>
            <div>
              <label for="qtyHalf">How many half dozens?</label>
              <select id="qtyHalf"></select>
            </div>
          </div>

          <button type="button" onclick="addToCart('half')">Add Half Dozens</button>
        </div>

        <!-- PACK 3: DOZEN -->
        <div class="pack">
          <div class="pack-title">
            <strong>Dozen (12)</strong>
            <span class="pill">$30 per 12</span>
          </div>

          <div class="row">
            <div>
              <label for="flavorDozen">Flavor</label>
              <select id="flavorDozen">
                <option>Blueberry</option>
                <option>Strawberry Lemon</option>
                <option>Chocolate Raspberry</option>
                <option>Double Chocolate</option>
              </select>
            </div>
            <div>
              <label for="qtyDozen">How many dozens?</label>
              <select id="qtyDozen"></select>
            </div>
          </div>

          <button type="button" onclick="addToCart('dozen')">Add Dozens</button>
        </div>
      </div>

      <div class="notice">
        <strong>Note:</strong> Each line item is one flavor. Add multiple lines if you want multiple flavors.
      </div>
    </div>

    <!-- RIGHT COLUMN -->
    <div class="card">
      <h2>Your Cart</h2>
      <p class="muted" id="cartEmptyText">Your cart is empty. Add something on the left.</p>

      <div id="cartArea" style="display:none;">
        <ul class="cart-list" id="cartList"></ul>
        <div class="divider"></div>
        <div class="total">Total: $<span id="cartTotal">0</span></div>
      </div>

      <div class="divider"></div>

      <h2>Customer Info</h2>
      <div style="display:grid; gap:10px;">
        <div>
          <label for="custName">Name</label>
          <input id="custName" placeholder="Your name" />
        </div>
        <div>
          <label for="custPhone">Phone (optional)</label>
          <input id="custPhone" placeholder="(555) 123-4567" />
        </div>
        

        <button type="button" onclick="submitOrder()">Submit Order (Email)</button>
        <button class="secondary" type="button" onclick="clearCart()">Clear Cart</button>

        <p class="muted" style="margin: 0;">
          This site uses email submission (no payment processing yet).
        </p>
      </div>
    </div>
  </div>

<!-- PAYMENT MODAL -->
<div id="paymentModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,.55); padding:16px; z-index:9999; overflow:auto; -webkit-overflow-scrolling:touch;">
  <div style="max-width:720px; margin:60px auto; background:#fff; border-radius:14px; padding:18px; box-shadow:0 10px 30px rgba(0,0,0,.25); max-height: calc(100vh - 120px); overflow:auto; -webkit-overflow-scrolling:touch;">
    <div style="display:flex; justify-content:space-between; gap:12px; align-items:flex-start;">
      <div>
        <h2 style="margin:0;">Payment Required</h2>
        <p style="margin:6px 0 0; color:#555;">
          Please pay to confirm your order. Include your Order # in the payment note/memo.
        </p>
      </div>
      <button type="button" class="secondary" onclick="closePaymentModal()" style="height:40px;">Close</button>
    </div>

    <div class="divider"></div>

    <div style="display:grid; gap:10px;">
      <div style="background:#faf6f1; border:1px solid #eee; border-radius:12px; padding:12px;">
        <div style="font-weight:900; font-size:18px;">
          Order #: <span id="orderNumberText"></span>
        </div>
        <div style="margin-top:6px; color:#555;">
          <strong>Deadline:</strong> Orders must be placed and paid before <strong>Wednesday 7am</strong>.
        </div>
        <div style="margin-top:6px; color:#555;">
          Confirmation will be sent via email or text <strong>no more than 12 hours after payment</strong>.
        </div>
      </div>

      <div style="border:1px solid #e6e6e6; border-radius:12px; padding:12px;">
  <div style="font-weight:900; margin-bottom:8px;">How will you pay?</div>

  <label for="payMethod" style="font-weight:700; font-size:13px;">Payment method (required)</label>
  <select id="payMethod" required style="margin-top:6px;">
    <option value="">Select…</option>
    <option value="Zelle">Zelle</option>
    <option value="Cash App">Cash App</option>
    <option value="Apple Pay">Apple Pay</option>
  </select>

  <label for="payHandle" style="font-weight:700; font-size:13px; margin-top:10px; display:block;">
    Payment name/handle (optional)
  </label>
  <input id="payHandle" placeholder="Example: John S. / $mycashapp / last 4 digits" style="margin-top:6px;" />
</div>

      <div style="display:grid; gap:10px;">
        <div style="border:1px solid #e6e6e6; border-radius:12px; padding:12px;">
          <div style="display:flex; justify-content:space-between; gap:10px; align-items:center;">
            <div>
              <div style="font-weight:900;">Zelle</div>
              <div id="zelleText" style="color:#555;">zachorii92@gmail.com</div>
            </div>
            <button type="button" onclick="copyText('zelleText')">Copy</button>
          </div>
        </div>

        <div style="border:1px solid #e6e6e6; border-radius:12px; padding:12px;">
          <div style="display:flex; justify-content:space-between; gap:10px; align-items:center;">
            <div>
              <div style="font-weight:900;">Cash App</div>
              <div id="cashappText" style="color:#555;">$zachorii</div>
            </div>
            <button type="button" onclick="copyText('cashappText')">Copy</button>
          </div>
        </div>

        <div style="border:1px solid #e6e6e6; border-radius:12px; padding:12px;">
          <div style="display:flex; justify-content:space-between; gap:10px; align-items:center;">
            <div>
              <div style="font-weight:900;">Apple Pay</div>
              <div id="applepayText" style="color:#555;">9729214688</div>
            </div>
            <button type="button" onclick="copyText('applepayText')">Copy</button>
          </div>
        </div>
      </div>

      <div class="divider"></div>

      <div>
        <h3 style="margin:0 0 6px;">Order Summary</h3>
        <pre id="orderSummaryText" style="margin:0; white-space:pre-wrap; background:#111; color:#fff; padding:12px; border-radius:12px; font-size:13px;"></pre>
      </div>

      <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:6px;">
        <button type="button" onclick="sendOrderEmailFromModal()">Confirm & Send Order</button>
      </div>

      <p style="margin:0; color:#666; font-size:12px;">
        Tip: Use the Order # in your payment note (ex: “MM-ABC123”).
      </p>
    </div>
  </div>
</div>
  
</main>
<script>
  // ---- CONFIG ----
  const YOUR_EMAIL = "drurylane.business@gmail.com";

  const PACKS = {
    single: { label: "Single", muffinsPerPack: 1, pricePerPack: 3 },
    half:   { label: "Half Dozen", muffinsPerPack: 6, pricePerPack: 15 },
    dozen:  { label: "Dozen", muffinsPerPack: 12, pricePerPack: 30 }
  };

  // Cart items look like:
  // { type: 'half', flavor: 'Blueberry', packQty: 2 }
  let cart = [];

  // Populate quantity dropdowns (safe)
  function fillQty(selectId, max) {
    const el = document.getElementById(selectId);
    if (!el) return;
    el.innerHTML = "";
    for (let i = 1; i <= max; i++) {
      const opt = document.createElement("option");
      opt.value = i;
      opt.textContent = i;
      el.appendChild(opt);
    }
  }

  // money formatting
  function money(n) { return Number(n).toFixed(2).replace(/\.00$/, ""); }

  // add to cart
  function addToCart(type) {
    const pack = PACKS[type];
    const flavorEl = document.getElementById(type === "single" ? "flavorSingle" : type === "half" ? "flavorHalf" : "flavorDozen");
    const qtyEl = document.getElementById(type === "single" ? "qtySingle" : type === "half" ? "qtyHalf" : "qtyDozen");
    if (!flavorEl || !qtyEl) return;

    const flavor = flavorEl.value;
    const packQty = parseInt(qtyEl.value, 10);

    // Merge with existing same type+flavor
    const existingIndex = cart.findIndex(i => i.type === type && i.flavor === flavor);
    if (existingIndex !== -1) {
      cart[existingIndex].packQty += packQty;
    } else {
      cart.push({ type, flavor, packQty });
    }

    renderCart();
  }

  function removeItem(index) {
    cart.splice(index, 1);
    renderCart();
  }

  function clearCart() {
    cart = [];
    renderCart();
  }

  function renderCart() {
    const list = document.getElementById("cartList");
    const totalEl = document.getElementById("cartTotal");
    const emptyText = document.getElementById("cartEmptyText");
    const cartArea = document.getElementById("cartArea");
    if (!list || !totalEl || !emptyText || !cartArea) return;

    list.innerHTML = "";

    if (cart.length === 0) {
      emptyText.style.display = "block";
      cartArea.style.display = "none";
      totalEl.textContent = "0";
      return;
    }

    emptyText.style.display = "none";
    cartArea.style.display = "block";

    let total = 0;

    cart.forEach((item, idx) => {
      const pack = PACKS[item.type];
      const muffins = item.packQty * pack.muffinsPerPack;
      const price = item.packQty * pack.pricePerPack;
      total += price;

      const li = document.createElement("li");
      li.className = "cart-item";
      li.innerHTML = `
        <div>
          <strong>${item.flavor}</strong>
          <small>${item.packQty} × ${pack.label} (${pack.muffinsPerPack} each) = ${muffins} muffins</small>
        </div>
        <div class="cart-actions">
          <strong>$${money(price)}</strong>
          <button class="remove-btn" type="button" onclick="removeItem(${idx})">Remove</button>
        </div>
      `;
      list.appendChild(li);
    });

    totalEl.textContent = money(total);
  }

  // ---- Payment modal + order generation ----
  let lastOrder = null;

  function generateOrderNumber() {
    const num = Math.floor(Math.random() * 10000); // 0-9999
    return num.toString().padStart(4, "0");
  }

  function openPaymentModal(orderNumber, summaryText) {
    const orderEl = document.getElementById("orderNumberText");
    const summaryEl = document.getElementById("orderSummaryText");
    const modal = document.getElementById("paymentModal");
    document.body.style.overflow = "hidden";
    if (orderEl) orderEl.textContent = orderNumber;
    if (summaryEl) summaryEl.textContent = summaryText;
    if (modal) modal.style.display = "block";
  }

  function closePaymentModal() {
    const modal = document.getElementById("paymentModal");
    document.body.style.overflow = "";
    if (modal) modal.style.display = "none";

    const methodEl = document.getElementById("payMethod");
    const handleEl = document.getElementById("payHandle");
    if (methodEl) methodEl.value = "";
    if (handleEl) handleEl.value = "";
  }

  async function copyText(elementId) {
    const el = document.getElementById(elementId);
    if (!el) return;
    const text = el.textContent.trim();
    try {
      await navigator.clipboard.writeText(text);
      alert("Copied!");
    } catch {
      // fallback
      const ta = document.createElement("textarea");
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      document.execCommand("copy");
      document.body.removeChild(ta);
      alert("Copied!");
    }
  }

  function submitOrder() {
    if (cart.length === 0) {
      alert("Your cart is empty. Add muffins first.");
      return;
    }

    const name = (document.getElementById("custName") && document.getElementById("custName").value.trim()) || "—";
    const phone = (document.getElementById("custPhone") && document.getElementById("custPhone").value.trim()) || "—";
    

    let lines = [];
    let total = 0;
    let totalMuffins = 0;

    cart.forEach(item => {
      const pack = PACKS[item.type];
      const muffins = item.packQty * pack.muffinsPerPack;
      const price = item.packQty * pack.pricePerPack;
      total += price;
      totalMuffins += muffins;

      lines.push(`${item.flavor} — ${item.packQty} × ${pack.label} (${pack.muffinsPerPack}) = ${muffins} muffins — $${money(price)}`);
    });

    const orderNumber = generateOrderNumber();

    const summaryText =
`Order #: ${orderNumber}

Customer: ${name}
Phone: ${phone}

Order:
${lines.join("\n")}

Total muffins: ${totalMuffins}
Total: $${money(total)}

`;

    lastOrder = { orderNumber, name, phone, summaryText };
    openPaymentModal(orderNumber, summaryText);
  }

  async function sendOrderEmailFromModal() {
  if (!lastOrder) return;

  const methodEl = document.getElementById("payMethod");
  const handleEl = document.getElementById("payHandle");

  const payMethod = methodEl ? methodEl.value.trim() : "";
  const payHandle = handleEl ? handleEl.value.trim() : "";

  if (!payMethod) {
    alert("Please select how you will pay.");
    return;
  }

  const FORM_ENDPOINT = "https://submit-form.com/OVM8b32N4";

  const payload = {
    orderNumber: lastOrder.orderNumber,
    name: lastOrder.name,
    phone: lastOrder.phone,
    paymentMethod: payMethod,
    paymentHandle: payHandle,
    orderDetails: lastOrder.summaryText
  };

  try {
    const response = await fetch(FORM_ENDPOINT, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(payload)
    });

    if (response.ok) {
      alert("Order sent successfully! Please complete payment.");
      closePaymentModal();
      clearCart();
    } else {
      alert("There was an issue sending the order. Please try again.");
    }
  } catch (error) {
    alert("Network error. Please try again.");
  }
}

  // DOM-ready init: populate selects and render cart
  document.addEventListener("DOMContentLoaded", () => {
    fillQty("qtySingle", 5);   // singles capped at 5
    fillQty("qtyHalf", 12);
    fillQty("qtyDozen", 12);
    renderCart();
  });
</script>


</body>
</html>
